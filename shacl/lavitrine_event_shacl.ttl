@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix schema: <http://schema.org/> .
@prefix sh: <http://www.w3.org/ns/shacl#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix ads: <http://kg.artsdata.ca/shacl/> .


####################################################
# Lavitrine Events SHACL v1
#
# Main difference with Artsdsata:
# Single Events are transformed into EventSeries (spectacle) 
# with a single subEvent (performance).
####################################################

ads:EventSeriesNode
    sh:description "An EventSeries is roughly equivalent to a spectacle. It is a collection of performance(s)."@en ;
    sh:targetClass schema:EventSeries ;
    sh:property ads:nameProp, 
                ads:descriptionPerLanguage,  
                ads:descriptionNotMissing,
                ads:locationProp, 
                ads:performerProp, 
                ads:organizerProp, 
                ads:subEventProp ;
    .

ads:nameProp
    sh:path schema:name ;
    sh:uniqueLang true ;
    sh:minCount 1 ;
    sh:severity sh:Violation ;
.

ads:descriptionPerLanguage
    sh:description "An Event **MUST** not have more than one description per language"@en ; 
    sh:path schema:description ;
    sh:uniqueLang true ;
    sh:severity sh:Violation ;
.

ads:descriptionNotMissing
    sh:description "An Event **SHOULD** have atleast one description"@en ;
    sh:path schema:description ;
    sh:minCount 1 ;
    sh:severity sh:Warning  .


ads:locationProp
    sh:description "An Event **MUST** have one location."@en ;
    sh:path schema:location ;
    sh:minCount 1  ;
    sh:maxCount 1  ;
    sh:or (
        [ sh:class schema:Place ; ]
        [ sh:class schema:VirtualLocation ; ]
    ) ;
    sh:severity sh:Violation ;
    # see shacl/lavitrine_place_shacl.ttl
.

ads:performerProp
    sh:path schema:performer ;
    sh:or (
        [ sh:class schema:Person ; ]
        [ sh:class schema:Organization ; ]
    ) .

ads:organizerProp
    sh:path schema:organizer ;
    sh:or (
        [ sh:class schema:Person ; ]
        [ sh:class schema:Organization ; ]
    ) ;
.

ads:subEventProp
    sh:description "An Event **MUST** have a subEvent (representation)"@en ; 
    sh:path schema:subEvent ;
    sh:minCount 1  ;
    sh:node sh:EventNode .


################
# Events
################

ads:EventNode
    sh:description "An Event is roughly equivalent to a representation."@en ;
    sh:targetClass  schema:Event ;
    sh:property ads:nameProp, 
                ads:startDateProp,
                ads:endDateProp,
                ads:offersProp,
                ads:eventStatusProp ,
                ads:eventAttendanceModeProp .

ads:startDateProp
    sh:path schema:startDate ;
    sh:or (
        [ sh:datatype xsd:dateTime ; ]
        [ sh:datatype xsd:date ; ]
    ) ;
    sh:maxCount 1 ;
    sh:minCount 1 .

ads:endDateProp
    sh:path schema:endDate ;
    sh:or (
        [ sh:datatype xsd:dateTime ; ]
        [ sh:datatype xsd:date ; ]
    ) ;
    sh:maxCount 1 ;
    sh:minCount 0 .

ads:offersProp
    sh:description "An Event **MUST** have a single Offer. If there are mulitple offers they must by nested in an AggregateOffer."@en ;
    sh:path schema:offers ;
    sh:minCount 1 ;
    sh:maxCount 1 ;
    sh:or (
        [ sh:node ads:AggregateOfferNode ; ]
        [ sh:node ads:OfferNode ; ]
    ) ;
    .

ads:eventStatusProp
    sh:description "An Event **SHOULD** have a status from the list."@en ;
    sh:path schema:eventStatus ;
    sh:minCount 1 ;
    sh:in  (    schema:EventCancelled
                schema:EventPostponed 
                schema:EventScheduled  
                schema:EventRescheduled  
                schema:EventMovedOnline ) ;
    sh:severity sh:Warning ;
.

ads:eventAttendanceModeProp
    sh:path schema:eventAttendanceMode ;
    sh:minCount 0 ;
    sh:in  (    schema:OnlineEventAttendanceMode
                schema:OfflineEventAttendanceMode 
                schema:HybridEventAttendanceMode ) 
    .
